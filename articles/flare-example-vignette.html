<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>FLAREr example • FLAREr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="FLAREr example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FLAREr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/flare-config-vignette.html">FLAREr configurations</a></li>
    <li><a class="dropdown-item" href="../articles/flare-example-vignette.html">FLAREr example</a></li>
    <li><a class="dropdown-item" href="../articles/flare-upgrade-vignette.html">FLAREr upgrade</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>FLAREr example</h1>
            
      

      <div class="d-none name"><code>flare-example-vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>This document serves as a users guide and a tutorial for the FLARE
(Forecasting Lake and Reservoir Ecosystems) system (<a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2019WR026138" class="external-link">Thomas
et al. 2020</a>). FLARE generates forecasts and forecast uncertainty of
water temperature and water quality for 1 to 35-dau ahead time horizon
at multiple depths of a lake or reservoir. It uses data assimilation to
update the initial starting point for a forecast and the model
parameters based a real-time statistical comparisons to observations. It
has been developed, tested, and evaluated for Falling Creek Reservoir in
Vinton,VA (<a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2019WR026138" class="external-link">Thomas
et al. 2020</a>) and National Ecological Observatory Network lakes (<a href="https://doi.org/10.1002/fee.2623" class="external-link">Thomas et al. 2023</a></p>
<p>FLARE is a set of R scripts that</p>
<ul>
<li>Generating the inputs and configuration files required by the
General Lake Model (GLM)</li>
<li>Applying data assimilation to GLM</li>
<li>Processing and archiving forecast output</li>
<li>Visualizing forecast output</li>
</ul>
<p>FLARE uses the 1-D General Lake Model (<a href="https://www.geosci-model-dev.net/12/473/2019/" class="external-link">Hipsey et
al. 2019</a>) as the mechanistic process model that predicts
hydrodynamics of the lake or reservoir. For forecasts of water quality,
it uses GLM with the Aquatic Ecosystem Dynamics library. The binaries
for GLM and GLM-AED are included in the FLARE code that is available on
GitHub. FLARE requires GLM version 3.3 or higher.</p>
<p>More information about the GLM can be found here:</p>
<ul>
<li><a href="https://www.geosci-model-dev.net/12/473/2019/" class="external-link">GLM 3.0.0
manuscript</a></li>
<li><a href="https://github.com/AquaticEcoDynamics/glm-aed" class="external-link">GLM on
GitHub</a></li>
<li><a href="https://aquaticecodynamics.github.io/glm-workbook/" class="external-link">GLM
users guide</a></li>
</ul>
<p>FLARE development has been supported by grants from National Science
Foundation (CNS-1737424, DEB-1753639, EF-1702506, DBI-1933016,
DEB-1926050)</p>
</div>
<div class="section level2">
<h2 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h2>
<ul>
<li><a href="https://rstudio.com/products/rstudio/download/" class="external-link">RStudio</a></li>
<li>
<code>FLAREr</code> R package</li>
<li>
<code>FLAREr</code> dependencies</li>
</ul>
</div>
<div class="section level2">
<h2 id="set-up">1: Set up<a class="anchor" aria-label="anchor" href="#set-up"></a>
</h2>
<p>First, install the <code>FLAREr</code> package from GitHub. There
will be other required packages that will also be downloaded.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"flare-forecast/FLAREr"</span><span class="op">)</span></span></code></pre></div>
<p>Second, download the General Lake Model (GLM) code. You can get in
using multiple pathways</p>
<p>The easiest way is to install the <code>GLM3r</code> package from
Github using</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"rqthomas/GLM3r"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using github PAT from envvar GITHUB_PAT. Use `gitcreds::gitcreds_set()` and unset GITHUB_PAT in .Renviron (or elsewhere) if you want to use the more secure git credential store instead.</span></span>
<span><span class="co">#&gt; Downloading GitHub repo rqthomas/GLM3r@HEAD</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="color: #00BBBB;">R CMD build</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; * checking for file ‘/tmp/Rtmpvwi2YJ/remotes1f4a28c34e5/rqthomas-GLM3r-977b223/DESCRIPTION’ ... OK</span></span>
<span><span class="co">#&gt; * preparing ‘GLM3r’:</span></span>
<span><span class="co">#&gt; * checking DESCRIPTION meta-information ... OK</span></span>
<span><span class="co">#&gt; * checking for LF line-endings in source and make files and shell scripts</span></span>
<span><span class="co">#&gt; * checking for empty or unneeded directories</span></span>
<span><span class="co">#&gt; * building ‘GLM3r_3.1.17.tar.gz’</span></span>
<span><span class="co">#&gt; Installing package into '/home/runner/work/_temp/Library'</span></span>
<span><span class="co">#&gt; (as 'lib' is unspecified)</span></span></code></pre></div>
<p>After installing GLM3r you need to set an environment variable that
points to the GLM code.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span><span class="st">'GLM_PATH'</span><span class="op">=</span><span class="st">'GLM3r'</span><span class="op">)</span></span></code></pre></div>
<p>Third, create a directory that will be your working directory for
your FLARE run. To find this directory on your computer you can use
<code>print(lake_directory)</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lake_directory</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,  winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"configuration/default"</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"targets"</span><span class="op">)</span><span class="op">)</span> <span class="co"># For QAQC data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"drivers"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Weather and inflow forecasts</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="configuration-files">2: Configuration files<a class="anchor" aria-label="anchor" href="#configuration-files"></a>
</h2>
<p>First, <code>FLAREr</code> requires two configuration yaml files. The
code below copies examples from the <code>FLAREr</code> package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"configure_flare.yml"</span>, package <span class="op">=</span> <span class="st">"FLAREr"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"configure_flare.yml"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"configure_run.yml"</span>, package <span class="op">=</span> <span class="st">"FLAREr"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"configure_run.yml"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Second, <code>FLAREr</code> requires a set of configuration CSV
files. The CSV files are used to define the states that are simulated
and the parameters that are calibrated. The code below copies examples
from the <code>FLAREr</code> package</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"parameter_calibration_config.csv"</span>, package <span class="op">=</span> <span class="st">"FLAREr"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"parameter_calibration_config.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"states_config.csv"</span>, package <span class="op">=</span> <span class="st">"FLAREr"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"states_config.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"depth_model_sd.csv"</span>, package <span class="op">=</span> <span class="st">"FLAREr"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"depth_model_sd.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"observations_config.csv"</span>, package <span class="op">=</span> <span class="st">"FLAREr"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"observations_config.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Third, FLAREr requires GLM specific configurations files. For
applications that require on water temperature, only the GLM namelist
file is needed. Applications that require other water quality variables
will require additional namelist files that are associated with the aed
model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"glm3.nml"</span>, package <span class="op">=</span> <span class="st">"FLAREr"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"configuration"</span>, <span class="st">"default"</span>, <span class="st">"glm3.nml"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="observation-and-driver-files">3: Observation and driver files<a class="anchor" aria-label="anchor" href="#observation-and-driver-files"></a>
</h2>
<p>Since the FLAREr package for general application, scripts to download
and process observation and drivers are not included in the package.
Therefore the application of FLARE to a lake will require a set of
additional scripts that are specific to the data formats for the lakes.
The example includes files for application to FCR.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/targets"</span>, package <span class="op">=</span> <span class="st">"FLAREr"</span><span class="op">)</span>, to <span class="op">=</span> <span class="va">lake_directory</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/drivers"</span>, package <span class="op">=</span> <span class="st">"FLAREr"</span><span class="op">)</span>, to <span class="op">=</span> <span class="va">lake_directory</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>First, FLAREr requires the observation file to have a specific name
(observations_postQAQC_long.csv) and format.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>,<span class="st">"targets/fcre/fcre-targets-insitu.csv"</span><span class="op">)</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   datetime            site_id depth observation variable   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2022-09-28 <span style="color: #949494;">00:00:00</span> fcre        0        20.5 temperature</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2022-09-29 <span style="color: #949494;">00:00:00</span> fcre        0        19.6 temperature</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2022-09-30 <span style="color: #949494;">00:00:00</span> fcre        0        18.8 temperature</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2022-10-01 <span style="color: #949494;">00:00:00</span> fcre        0        17.2 temperature</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2022-10-02 <span style="color: #949494;">00:00:00</span> fcre        0        16.0 temperature</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2022-10-03 <span style="color: #949494;">00:00:00</span> fcre        0        15.4 temperature</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="configure-simulation-glm">2: Configure simulation (GLM)<a class="anchor" aria-label="anchor" href="#configure-simulation-glm"></a>
</h2>
<p>The configuration functions are spread across the files. These files
are described in more detail below</p>
<ul>
<li><code>glm3.nml</code></li>
<li><code>configure_flare.yml</code></li>
<li><code>configure_run.yml</code></li>
<li><code>states_config.csv</code></li>
<li><code>observations_config.csv</code></li>
<li><code>parameter_calibration_config.csv</code></li>
<li><code>depth_model_sd.csv</code></li>
</ul>
<div class="section level3">
<h3 id="configure_run-yml">configure_run.yml<a class="anchor" aria-label="anchor" href="#configure_run-yml"></a>
</h3>
<p>This file is the configuration file that define the specific timing
of the run.</p>
<ul>
<li>
<code>restart_file</code>: This is the full path to the file that
you want to use as initial conditions for the simulation. You will set
this to <code>NA</code> if the simulation is not a continuation of a
previous simulation.</li>
<li>
<code>sim_name</code>: a string with the name of your simulation.
This will appear in your output file names</li>
<li>
<code>forecast_days</code>: This is your forecast horizon. The max
is <code>16</code> days. Set to <code>0</code>if only doing data
assimilation with observed drivers.</li>
<li>
<code>start_datetime</code>: The date time of day you want to start
a forecast. Because GLM is a daily timestep model, the simulation will
start at this time. It uses <code>YYYY-MM-DD mm:hh:ss</code> format and
must only be a whole hour. It is in the UTC time. It can be any hour if
only doing data assimilation with observed drivers (forecast_days = 0).
If forecasting (forecast_days &gt; 0) it is required to match up with
the availability of a NOAA forecast. NOAA forecasts are available at the
following times UTC so you must select a local time that matches one of
these times (i.e., 07:00:00 at FCR is the 12:00:00 UTC NOAA forecast).
<ul>
<li>00:00:00 UTC</li>
<li>06:00:00 UTC</li>
<li>12:00:00 UTC</li>
<li>18:00:00 UTC</li>
</ul>
</li>
<li>
<code>forecast_start_datetime</code>: The date that you want
forecasting to start in your simulation. Uses the YYYY-MM-DD mm:hh:ss
format (e.g., “2019-09-20 00:00:00”). The difference between
<code>start_time</code> and <code>forecast_start_datetime</code>
determines how many days of data assimilation occur using observed
drivers before handing off to forecasted drivers and not assimilating
data</li>
<li>
<code>configure_flare</code>: name of FLARE configuration file
located in your <code>configuration/[config_set]</code> directory
(<code>configure_flare.yml</code>)</li>
<li>
<code>configure_obs</code>: name of optional observation processing
configuration file located in your
<code>configuration/[config_set]</code> directory
(<code>configure_obs.yml</code>)</li>
<li>
<code>use_s3</code>: use s3 cloud storage for saving forecast,
scores, and restart files.</li>
</ul>
</div>
<div class="section level3">
<h3 id="glm3-nml">glm3.nml<a class="anchor" aria-label="anchor" href="#glm3-nml"></a>
</h3>
<p><code>glm3.nml</code> is the configuration file that is required by
GLM. It can be configured to run only GLM or GLM + AED. This version is
already configured to run only GLM for FCR and you do not need to modify
it for the example simulation.</p>
</div>
<div class="section level3">
<h3 id="configure_flare-yml">configure_flare.yml<a class="anchor" aria-label="anchor" href="#configure_flare-yml"></a>
</h3>
<p><code>configure_flare.yml</code> has the bulk of the configurations
for FLARE that you will set once and reuse. The end of this document
describes all of the configurations in <code>configure_flare.yml</code>.
Later in the tutorial, you will modify key configurations in
<code>configure_flare.yml</code></p>
</div>
<div class="section level3">
<h3 id="states_config-csv">states_config.csv<a class="anchor" aria-label="anchor" href="#states_config-csv"></a>
</h3>
<p>Needs to be in <code>configuration/[config_set]</code></p>
</div>
<div class="section level3">
<h3 id="observations_config-csv">observations_config.csv<a class="anchor" aria-label="anchor" href="#observations_config-csv"></a>
</h3>
<p>Needs to be in your <code>configuration/[config_set]</code></p>
</div>
<div class="section level3">
<h3 id="parameter_calibration_config-csv">parameter_calibration_config.csv<a class="anchor" aria-label="anchor" href="#parameter_calibration_config-csv"></a>
</h3>
<p>Needs to be in your <code>configuration/[config_set]</code></p>
</div>
</div>
<div class="section level2">
<h2 id="run-your-glm-example-simulation">3: Run your GLM example simulation<a class="anchor" aria-label="anchor" href="#run-your-glm-example-simulation"></a>
</h2>
<p>Read configuration files</p>
<p>The following reads in the configuration files and overwrites the
directory locations based on the lake_directory and directories provided
above. In practice you will specific these directories in the configure
file and not overwrite them.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">next_restart</span> <span class="op">&lt;-</span> <span class="fu">FLAREr</span><span class="fu">::</span><span class="fu"><a href="../reference/run_flare.html">run_flare</a></span><span class="op">(</span>lake_directory <span class="op">=</span> <span class="va">lake_directory</span>,configure_run_file <span class="op">=</span> <span class="st">"configure_run.yml"</span>, config_set_name <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in set_up_simulation(configure_run_file, lake_directory, clean_start =</span></span>
<span><span class="co">#&gt; clean_start, : NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in set_up_simulation(configure_run_file, lake_directory, clean_start =</span></span>
<span><span class="co">#&gt; clean_start, : NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in set_up_simulation(configure_run_file, lake_directory, clean_start =</span></span>
<span><span class="co">#&gt; clean_start, : NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in set_up_simulation(configure_run_file, lake_directory, clean_start =</span></span>
<span><span class="co">#&gt; clean_start, : NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in set_up_simulation(configure_run_file, lake_directory, clean_start =</span></span>
<span><span class="co">#&gt; clean_start, : NAs introduced by coercion</span></span>
<span><span class="co">#&gt;      Running forecast that starts on: 2022-09-28 00:00:00</span></span>
<span><span class="co">#&gt; Retrieving Observational Data...</span></span>
<span><span class="co">#&gt; Generating Met Forecasts...</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'tsibble':</span></span>
<span><span class="co">#&gt;   method               from </span></span>
<span><span class="co">#&gt;   as_tibble.grouped_df dplyr</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span><span class="co">#&gt; Creating inflow/outflow files...</span></span>
<span><span class="co">#&gt; Setting states and initial conditions...</span></span>
<span><span class="co">#&gt; Running time step 1/20 : 2022-09-28 00:00 - 2022-09-29 00:00 [2024-10-04 18:32:26.547575]</span></span>
<span><span class="co">#&gt; performing data assimilation</span></span>
<span><span class="co">#&gt; zone1temp: mean 10.8857 sd 1.123</span></span>
<span><span class="co">#&gt; zone2temp: mean 14.1658 sd 1.1801</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9652 sd 0.066</span></span>
<span><span class="co">#&gt; Running time step 2/20 : 2022-09-29 00:00 - 2022-09-30 00:00 [2024-10-04 18:32:33.090336]</span></span>
<span><span class="co">#&gt; performing data assimilation</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.0377 sd 1.1773</span></span>
<span><span class="co">#&gt; zone2temp: mean 14.3356 sd 1.3052</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9852 sd 0.0563</span></span>
<span><span class="co">#&gt; Running time step 3/20 : 2022-09-30 00:00 - 2022-10-01 00:00 [2024-10-04 18:32:39.395488]</span></span>
<span><span class="co">#&gt; performing data assimilation</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.8072 sd 0.9291</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.9755 sd 1.707</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9076 sd 0.0434</span></span>
<span><span class="co">#&gt; Running time step 4/20 : 2022-10-01 00:00 - 2022-10-02 00:00 [2024-10-04 18:32:45.759166]</span></span>
<span><span class="co">#&gt; performing data assimilation</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.6061 sd 1.1831</span></span>
<span><span class="co">#&gt; zone2temp: mean 13.2888 sd 1.8014</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.947 sd 0.0432</span></span>
<span><span class="co">#&gt; Running time step 5/20 : 2022-10-02 00:00 - 2022-10-03 00:00 [2024-10-04 18:32:52.178942]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.5244 sd 1.8083</span></span>
<span><span class="co">#&gt; zone2temp: mean 13.0512 sd 1.8351</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9472 sd 0.0474</span></span>
<span><span class="co">#&gt; Running time step 6/20 : 2022-10-03 00:00 - 2022-10-04 00:00 [2024-10-04 18:32:58.560361]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.3803 sd 2.4174</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.9521 sd 1.953</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9585 sd 0.0527</span></span>
<span><span class="co">#&gt; Running time step 7/20 : 2022-10-04 00:00 - 2022-10-05 00:00 [2024-10-04 18:33:04.831967]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.2899 sd 2.5976</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.9694 sd 2.2027</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9581 sd 0.054</span></span>
<span><span class="co">#&gt; Running time step 8/20 : 2022-10-05 00:00 - 2022-10-06 00:00 [2024-10-04 18:33:11.139152]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.1126 sd 3.1169</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.6374 sd 2.5558</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9601 sd 0.0638</span></span>
<span><span class="co">#&gt; Running time step 9/20 : 2022-10-06 00:00 - 2022-10-07 00:00 [2024-10-04 18:33:17.466995]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.2196 sd 3.2648</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.3821 sd 2.5852</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9617 sd 0.0666</span></span>
<span><span class="co">#&gt; Running time step 10/20 : 2022-10-07 00:00 - 2022-10-08 00:00 [2024-10-04 18:33:23.719004]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.0348 sd 3.4857</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.2284 sd 3.1018</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9644 sd 0.073</span></span>
<span><span class="co">#&gt; Running time step 11/20 : 2022-10-08 00:00 - 2022-10-09 00:00 [2024-10-04 18:33:30.035897]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.2301 sd 3.4191</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.1017 sd 3.3726</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9685 sd 0.0734</span></span>
<span><span class="co">#&gt; Running time step 12/20 : 2022-10-09 00:00 - 2022-10-10 00:00 [2024-10-04 18:33:36.315135]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.1753 sd 3.5736</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.0448 sd 3.3292</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9658 sd 0.0812</span></span>
<span><span class="co">#&gt; Running time step 13/20 : 2022-10-10 00:00 - 2022-10-11 00:00 [2024-10-04 18:33:42.642708]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.1384 sd 3.8501</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.2788 sd 3.8034</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9709 sd 0.0831</span></span>
<span><span class="co">#&gt; Running time step 14/20 : 2022-10-11 00:00 - 2022-10-12 00:00 [2024-10-04 18:33:48.955471]</span></span>
<span><span class="co">#&gt; zone1temp: mean 10.9551 sd 4.0738</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.4865 sd 3.5276</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9703 sd 0.0892</span></span>
<span><span class="co">#&gt; Running time step 15/20 : 2022-10-12 00:00 - 2022-10-13 00:00 [2024-10-04 18:33:55.243362]</span></span>
<span><span class="co">#&gt; zone1temp: mean 10.9337 sd 4.2939</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.3107 sd 3.6883</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9728 sd 0.0889</span></span>
<span><span class="co">#&gt; Running time step 16/20 : 2022-10-13 00:00 - 2022-10-14 00:00 [2024-10-04 18:34:01.5306]</span></span>
<span><span class="co">#&gt; zone1temp: mean 10.8646 sd 4.3379</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.7352 sd 3.9142</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.971 sd 0.0949</span></span>
<span><span class="co">#&gt; Running time step 17/20 : 2022-10-14 00:00 - 2022-10-15 00:00 [2024-10-04 18:34:07.785718]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.0585 sd 4.7625</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.6473 sd 4.2614</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9713 sd 0.0985</span></span>
<span><span class="co">#&gt; Running time step 18/20 : 2022-10-15 00:00 - 2022-10-16 00:00 [2024-10-04 18:34:14.06349]</span></span>
<span><span class="co">#&gt; zone1temp: mean 11.1435 sd 4.9173</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.719 sd 4.4483</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9715 sd 0.0995</span></span>
<span><span class="co">#&gt; Running time step 19/20 : 2022-10-16 00:00 - 2022-10-17 00:00 [2024-10-04 18:34:20.384403]</span></span>
<span><span class="co">#&gt; zone1temp: mean 10.9883 sd 4.9468</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.6822 sd 4.2867</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9721 sd 0.1084</span></span>
<span><span class="co">#&gt; Running time step 20/20 : 2022-10-17 00:00 - 2022-10-18 00:00 [2024-10-04 18:34:26.703298]</span></span>
<span><span class="co">#&gt; zone1temp: mean 10.9189 sd 4.9409</span></span>
<span><span class="co">#&gt; zone2temp: mean 12.5622 sd 4.6109</span></span>
<span><span class="co">#&gt; lw_factor: mean 0.9674 sd 0.1093</span></span>
<span><span class="co">#&gt; Writing restart</span></span>
<span><span class="co">#&gt; Writing forecast</span></span>
<span><span class="co">#&gt; starting writing dataset</span></span>
<span><span class="co">#&gt; ending writing dataset</span></span>
<span><span class="co">#&gt; successfully generated flare forecats for: fcre-2022-10-02-test</span></span></code></pre></div>
<p>Visualizing output</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">open_dataset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>,<span class="st">"forecasts/parquet"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 14</span></span></span>
<span><span class="co">#&gt;   reference_datetime  datetime            pub_datetime        depth family  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2022-10-02 <span style="color: #949494;">00:00:00</span> 2022-09-28 <span style="color: #949494;">00:00:00</span> 2024-10-04 <span style="color: #949494;">18:34:33</span>     0 ensemble</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2022-10-02 <span style="color: #949494;">00:00:00</span> 2022-09-28 <span style="color: #949494;">00:00:00</span> 2024-10-04 <span style="color: #949494;">18:34:33</span>     0 ensemble</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2022-10-02 <span style="color: #949494;">00:00:00</span> 2022-09-28 <span style="color: #949494;">00:00:00</span> 2024-10-04 <span style="color: #949494;">18:34:33</span>     0 ensemble</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2022-10-02 <span style="color: #949494;">00:00:00</span> 2022-09-28 <span style="color: #949494;">00:00:00</span> 2024-10-04 <span style="color: #949494;">18:34:33</span>     0 ensemble</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2022-10-02 <span style="color: #949494;">00:00:00</span> 2022-09-28 <span style="color: #949494;">00:00:00</span> 2024-10-04 <span style="color: #949494;">18:34:33</span>     0 ensemble</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2022-10-02 <span style="color: #949494;">00:00:00</span> 2022-09-28 <span style="color: #949494;">00:00:00</span> 2024-10-04 <span style="color: #949494;">18:34:33</span>     0 ensemble</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 9 more variables: parameter &lt;int&gt;, variable &lt;chr&gt;, prediction &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   forecast &lt;dbl&gt;, variable_type &lt;chr&gt;, log_weight &lt;dbl&gt;, site_id &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   model_id &lt;chr&gt;, reference_date &lt;chr&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"temperature"</span>,</span>
<span>         <span class="va">depth</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span>, group <span class="op">=</span> <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="va">reference_datetime</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"1 m water temperature forecast"</span><span class="op">)</span></span></code></pre></div>
<p><img src="flare-example-vignette_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">targets_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">lake_directory</span>, <span class="st">"targets/fcre/fcre-targets-insitu.csv"</span><span class="op">)</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">combined_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">targets_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">datetime</span>, <span class="va">depth</span>, <span class="va">variable</span>, <span class="va">site_id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">combined_df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"temperature"</span>,</span>
<span>         <span class="va">depth</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span>, group <span class="op">=</span> <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="va">reference_datetime</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">observation</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"1 m water temperature forecast"</span><span class="op">)</span></span></code></pre></div>
<p><img src="flare-example-vignette_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"lw_factor"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span>, group <span class="op">=</span> <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="va">reference_datetime</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"lw_factor parameter"</span><span class="op">)</span></span></code></pre></div>
<p><img src="flare-example-vignette_files/figure-html/unnamed-chunk-16-1.png" width="700">
## 5. Comparing to observations</p>
</div>
<div class="section level2">
<h2 id="modifying-flare">6: Modifying FLARE<a class="anchor" aria-label="anchor" href="#modifying-flare"></a>
</h2>
<div class="section level3">
<h3 id="turning-off-data-assimilation">Turning off data assimilation<a class="anchor" aria-label="anchor" href="#turning-off-data-assimilation"></a>
</h3>
<p>In configure_flare.yml you can change <code>da_method</code> to
“none”</p>
</div>
<div class="section level3">
<h3 id="removing-parameter-estimation">Removing parameter estimation<a class="anchor" aria-label="anchor" href="#removing-parameter-estimation"></a>
</h3>
<p>Set <code>par_config_file = .na</code> in the
<code>configure_flare.yml</code></p>
</div>
<div class="section level3">
<h3 id="increasing-observational-uncertainty">Increasing observational uncertainty<a class="anchor" aria-label="anchor" href="#increasing-observational-uncertainty"></a>
</h3>
<p>The second modification you will do is to to increase the
observational uncertainty. In <code>observations_config.csv</code> set
<code>obs_sd = 1</code>.</p>
</div>
<div class="section level3">
<h3 id="changing-the-ensemble-size">Changing the ensemble size<a class="anchor" aria-label="anchor" href="#changing-the-ensemble-size"></a>
</h3>
<p>The variable <code>ensemble_size</code> allows you to adjust the size
of the ensemble.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by R. Quinn Thomas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
