<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run ensemble data assimilation and/or produce forecasts — run_da_forecast • FLAREr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run ensemble data assimilation and/or produce forecasts — run_da_forecast"><meta name="description" content="Run ensemble data assimilation and/or produce forecasts"><meta property="og:description" content="Run ensemble data assimilation and/or produce forecasts"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FLAREr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/flare-config-vignette.html">FLAREr configurations</a></li>
    <li><a class="dropdown-item" href="../articles/flare-example-vignette.html">FLAREr example</a></li>
    <li><a class="dropdown-item" href="../articles/flare-upgrade-vignette.html">FLAREr upgrade</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run ensemble data assimilation and/or produce forecasts</h1>

      <div class="d-none name"><code>run_da_forecast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run ensemble data assimilation and/or produce forecasts</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_da_forecast</span><span class="op">(</span></span>
<span>  <span class="va">states_init</span>,</span>
<span>  pars_init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">aux_states_init</span>,</span>
<span>  <span class="va">obs</span>,</span>
<span>  <span class="va">obs_sd</span>,</span>
<span>  <span class="va">model_sd</span>,</span>
<span>  <span class="va">working_directory</span>,</span>
<span>  <span class="va">met_file_names</span>,</span>
<span>  inflow_file_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outflow_file_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">config</span>,</span>
<span>  pars_config <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">states_config</span>,</span>
<span>  <span class="va">obs_config</span>,</span>
<span>  da_method <span class="op">=</span> <span class="st">"enkf"</span>,</span>
<span>  par_fit_method <span class="op">=</span> <span class="st">"perturb"</span>,</span>
<span>  obs_secchi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  obs_depth <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-states-init">states_init<a class="anchor" aria-label="anchor" href="#arg-states-init"></a></dt>
<dd><p>array of the initial states.  Required dimensions are <code>[states, depths, ensemble]</code></p></dd>


<dt id="arg-pars-init">pars_init<a class="anchor" aria-label="anchor" href="#arg-pars-init"></a></dt>
<dd><p>array of the initial states.  Required dimensions are <code>[pars, depths, ensemble]</code>.  (Default = NULL)</p></dd>


<dt id="arg-aux-states-init">aux_states_init<a class="anchor" aria-label="anchor" href="#arg-aux-states-init"></a></dt>
<dd><p>list of initial conditions for auxillary states.  These are states in the GLM that
are require for restarting the model but are not included in data assimilation.  These are states that are not associated
with a value in <code>model_sd</code>.</p></dd>


<dt id="arg-obs">obs<a class="anchor" aria-label="anchor" href="#arg-obs"></a></dt>
<dd><p>array; array of the observations. Required dimensions are <code>[nobs, time, depth]</code></p></dd>


<dt id="arg-obs-sd">obs_sd<a class="anchor" aria-label="anchor" href="#arg-obs-sd"></a></dt>
<dd><p>vector; vector of standard deviation for observation</p></dd>


<dt id="arg-model-sd">model_sd<a class="anchor" aria-label="anchor" href="#arg-model-sd"></a></dt>
<dd><p>vector vector of standard deviations describing the model error for each state</p></dd>


<dt id="arg-working-directory">working_directory<a class="anchor" aria-label="anchor" href="#arg-working-directory"></a></dt>
<dd><p>string; full path to directory where model executes</p></dd>


<dt id="arg-met-file-names">met_file_names<a class="anchor" aria-label="anchor" href="#arg-met-file-names"></a></dt>
<dd><p>vector; vector of full path meteorology file names</p></dd>


<dt id="arg-inflow-file-names">inflow_file_names<a class="anchor" aria-label="anchor" href="#arg-inflow-file-names"></a></dt>
<dd><p>vector or matrix;; vector of inflow file names</p></dd>


<dt id="arg-outflow-file-names">outflow_file_names<a class="anchor" aria-label="anchor" href="#arg-outflow-file-names"></a></dt>
<dd><p>vector or matrix; vector of outflow file names</p></dd>


<dt id="arg-config">config<a class="anchor" aria-label="anchor" href="#arg-config"></a></dt>
<dd><p>list; list of configurations</p></dd>


<dt id="arg-pars-config">pars_config<a class="anchor" aria-label="anchor" href="#arg-pars-config"></a></dt>
<dd><p>list; list of parameter configurations  (Default = NULL)</p></dd>


<dt id="arg-states-config">states_config<a class="anchor" aria-label="anchor" href="#arg-states-config"></a></dt>
<dd><p>list; list of state configurations</p></dd>


<dt id="arg-obs-config">obs_config<a class="anchor" aria-label="anchor" href="#arg-obs-config"></a></dt>
<dd><p>list; list of observation configurations</p></dd>


<dt id="arg-da-method">da_method<a class="anchor" aria-label="anchor" href="#arg-da-method"></a></dt>
<dd><p>string; data assimilation method (enkf or pf; Default = enkf)</p></dd>


<dt id="arg-par-fit-method">par_fit_method<a class="anchor" aria-label="anchor" href="#arg-par-fit-method"></a></dt>
<dd><p>string; method for adding noise to parameters during calibration</p></dd>


<dt id="arg-obs-secchi">obs_secchi<a class="anchor" aria-label="anchor" href="#arg-obs-secchi"></a></dt>
<dd><p>list of secchi observations</p></dd>


<dt id="arg-obs-depth">obs_depth<a class="anchor" aria-label="anchor" href="#arg-obs-depth"></a></dt>
<dd><p>list of depth observations</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Uses the ensemble data assimilation to predict water quality for a lake
or reservoir.  The function requires the initial conditions (<code>states_init</code>) for each
state and ensemble member using an array with the following dimension order:
states, depth, ensembles member.  If you are fitting parameters, it also requires
initial conditions for each parameter and ensemble member using an array (<code>par_init</code>) with the
following dimension order: parameters, ensemble member.  The arrays for states_init
and pars_init can be created using the <code><a href="generate_initial_conditions.html">generate_initial_conditions()</a></code> function, if
starting from initial conditions in the  <code>states_config</code> data frame or from observations
in first time column of the <code>obs</code> array.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by R. Quinn Thomas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

